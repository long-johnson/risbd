*************
* 8 запрос: *
*************
ƒл€ заданного покупател€ (выбираетс€ из списка всех покупателей, содержащего фамилию, им€, отчество и дату рождени€) сформировать в виде Word-документа отчЄт,
включающий его персональные данные и таблицу со списком всех его покупок (совершЄнных за наличный и безналичный расчЄт) за заданный период времени.
ќ покупателе должна быть отображена следующа€ информаци€: ‘»ќ, дата рождени€, e-mail, телефон, сери€ и номер паспорта.
ƒанные в списке покупок должны включать дату покупки, категорию товара, название фирмы-производител€, модель товара, сумму покупки и способ оплаты.
ќтсортировать список следующим образом: дата, категори€ товара, название фирмы, мо-дель товара.
ќграничение на максимальное врем€ выполнени€ запроса:
«апрос дл€ получени€ списка покупателей и дополнительных персональных данных, нуж-ных дл€ отчЄта:
? в приложении Ц 1830 мс;
? использу€ explain analyze Ц 1700 мс.
«апрос, получающий данные о покупателе, выбранном из списка:
? в приложении Ц 40 мс;
? использу€ explain analyze Ц 40 мс.
«апрос, получающий данные дл€ таблицы:
? в приложении Ц 180 мс;
? использу€ explain analyze Ц 170 мс.
-------------------------------------------------------------------------------------------------------------------------------------------------------

(1 вариант)

-- ѕеренесем столбцы таблицы Companies на сервер B

create table public.companies_2part AS
(
select * from 
	public.dblink ('host=students.ami.nstu.ru dbname=risbd4 user=risbd4 password=ris14bd4',
			'select *
			from initial.companies_2part') 
	as A(id integer, head_full_name text, phone text, address text, bank_details text)
order by head_full_name, id
)

-- добавим ключи, индексы

ALTER TABLE companies_2part ADD PRIMARY KEY (id);
create INDEX fki_companies_2part_id ON companies_2part(id);

-- напишем запрос
select * from companies_2part

"Seq Scan on companies_2part  (cost=0.00..25.98 rows=598 width=236) (actual time=0.010..0.640 rows=598 loops=1)"
"Total runtime: 1.146 ms"



-- ¬се теперь ќ ќ ќ ќ  ќ ќ ќ ќ ќ 
